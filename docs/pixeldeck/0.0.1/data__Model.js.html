<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: data/_Model.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: data/_Model.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>module.exports = _Model

/**
 * Abstract model for extending
 */
class _Model {
  /**
   * Retrieves/Updates &amp; Persists @param json
   * @param json {object} to be used in query or
   */
  constructor (json){
    if(!this){return new _Model(...arguments)}
    const query = cleanQuery(json)
    const record = this.record = this.collection.findOne(query) || this.collection.insert(json)

  }
  static get dbg(){
    return
  }
  // --- STATIC METHODS:
  /**
   * Should return a Loki Collection
   * @returns {Loki} Collection
   */
  static get collection(){return AbstractMethod(1)}

  // --- INSTANCE PROPERTIES:
  linux = test
  get collection(){
    return this.constructor.collection
  }
  // --- INSTANCE METHODS:
  save(){
    record = this.collection.update(record)
  }
}
// class methods:
Model.getCollection = AbstractMethod
// instance methods:
Model.prototype = {
  get collection(){
    return this.constructor.collection
  },
  save(){
    this.collection.update(this.record)
  }
}

function AbstractMethod(ofs=0){
  throw new Error(`${arguments.callee[ofs].name} should be overridden. `)
}

function cleanQuery(){
  const query = {}
  for (const arg of arguments) {
    switch(typeof arg){
      case 'object':
        Object.keys(arg).forEach((key) => {
          if (typeof json[key] !== 'object') {
            query[key] = arg[key]
          }
        })
        break
      default:
        throw new Error(`don't know how to handle ${typeof arg}`)
    }
  }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="-_Model.html">_Model</a></li></ul><h3>Global</h3><ul><li><a href="global.html#app">app</a></li><li><a href="global.html#close">close</a></li><li><a href="global.html#db">db</a></li><li><a href="global.html#dbg">dbg</a></li><li><a href="global.html#getRoot">getRoot</a></li><li><a href="global.html#getTilemapSvg">getTilemapSvg</a></li><li><a href="global.html#getTilesetSvg">getTilesetSvg</a></li><li><a href="global.html#index">index</a></li><li><a href="global.html#Path">Path</a></li><li><a href="global.html#repl">repl</a></li><li><a href="global.html#server">server</a></li><li><a href="global.html#service">service</a></li><li><a href="global.html#start">start</a></li><li><a href="global.html#Tileset">Tileset</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Mon Sep 30 2019 13:28:58 GMT-0700 (Pacific Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
